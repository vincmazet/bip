
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Correction of lab 5 &#8212; Basics of Image Processing</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jbvinc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/jbvinc-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 6" href="lab6.html" />
    <link rel="prev" title="Lab 5" href="lab5.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">Basics of Image Processing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Foreword
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Digital images
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/definition.html">
   What is a digital image?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/display.html">
   Displaying an image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/operations.html">
   Arithmetic operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/histogram.html">
   Histogram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/transformations.html">
   Histogram transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Filtering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/convolution.html">
   Convolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/fourier.html">
   Fourier transform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/filtering.html">
   Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Compression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/lossless.html">
   Lossless compression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/lossy.html">
   Lossy compression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Mathematical morphology
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/basics.html">
   Basic operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/composition.html">
   Composition of basic operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/measure.html">
   Measure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Segmentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/histogram.html">
   Histogram thresholding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/clustering.html">
   Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/region-growing.html">
   Region growing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/watershed.html">
   Watershed
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/evaluation.html">
   How to evaluate a segmentation?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Restoration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../restoration/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../restoration/denoising.html">
   Denoising
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../restoration/deconvolution.html">
   Deconvolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../restoration/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Feature detection
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/matched-filter.html">
   Matched filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/pattern.html">
   Pattern detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/edges.html">
   Edge detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/corners.html">
   Corner detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/lines.html">
   Line detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lab1.html">
   Lab 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="correc1.html">
     Correction of lab 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lab2.html">
   Lab 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="correc2.html">
     Correction of lab 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lab3.html">
   Lab 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="correc3.html">
     Correction of lab 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lab4.html">
   Lab 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="correc4.html">
     Correction of lab 4
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="lab5.html">
   Lab 5
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Correction of lab 5
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="lab6.html">
   Lab 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="correc6.html">
     Correction of lab 6
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  In a nutshell
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../nutshell/optimization.html">
   Mathematical optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nutshell/classification.html">
   Classification
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://moodle.unistra.fr/course/view.php?id=7653">
   Moodle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/python.html">
   Installing and using Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/refs.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/license.html">
   License
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/labs/correc5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising">
   Denoising
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#original-image-and-noisy-image">
     Original image and noisy image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-filter">
     Mean filter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tv-denoising">
     TV denoising
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparison-of-the-two-denoising-methods-for-different-snrs">
     Comparison of the two denoising methods for different SNRs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deconvolution">
   Déconvolution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#original-and-noisy-images">
     Original and noisy images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse-filter-on-the-non-noisy-image">
     Inverse filter on the non-noisy image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse-filter-with-noise">
     Inverse filter with noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wiener-filter-with-noise">
     Wiener filter with noise
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="correction-of-lab-5">
<span id="correc5"></span><h1>Correction of lab 5<a class="headerlink" href="#correction-of-lab-5" title="Permalink to this headline">¶</a></h1>
<div class="section" id="denoising">
<h2>Denoising<a class="headerlink" href="#denoising" title="Permalink to this headline">¶</a></h2>
<p>The objectives of this exercise are:</p>
<ul class="simple">
<li><p>to apply a white Gaussian noise with a specific SNR on an image</p></li>
<li><p>to implement a denoising method</p></li>
<li><p>to understand the effects of the parameters and set it accordingly to the epexpected solution</p></li>
</ul>
<p>Two denoising methods are considerer in this correction: the mean filter and TV regularization.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="section" id="original-image-and-noisy-image">
<h3>Original image and noisy image<a class="headerlink" href="#original-image-and-noisy-image" title="Permalink to this headline">¶</a></h3>
<p>THe original image:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_7_0.png" src="../_images/correc5_7_0.png" />
</div>
</div>
<p>The signal-to-noise ratio (SNR) is defined as the power of the image <span class="math notranslate nohighlight">\(x\)</span> divided by the power of the noise <span class="math notranslate nohighlight">\(b\)</span>.
Besides, it is generally given with a logarithmic scale.</p>
<div class="math notranslate nohighlight">
\[
\mathrm{SNR} = 10 \log_{10} \left(\frac{P_x}{P_b}\right)
\quad\Leftrightarrow\quad
10^\frac{\mathrm{SNR}}{10} = \frac{P_x}{P_b}
\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[
Px = \frac{1}{MN} \sum_{m,n} x(m,n)^2
\quad\text{et}\quad
Pb = \frac{1}{MN} \sum_{m,n} b(m,n)^2 = \sigma^2
\]</div>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
                     &amp;P_b = \frac{P_x}{10^\frac{\mathrm{SNR}}{10}} \\
\Leftrightarrow\quad &amp;\sigma^2 = P_x \times 10^{-\frac{\mathrm{SNR}}{10}} \\
\Leftrightarrow\quad &amp;\sigma^2 = \frac{1}{MN} \sum_{m,n} x(m,n)^2 10^{-\frac{\mathrm{SNR}}{10}} \\
\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\sqrt{\sum_{m,n} x(m,n)^2} \)</span> corresponds to the Frobenius norm of <span class="math notranslate nohighlight">\(x\)</span> and can be calculated with <code class="docutils literal notranslate"><span class="pre">numpy.linalg.norm</span></code>.</p>
<p>The figures below represent the image at different noise levels.</p>
<p><strong>Warning:</strong> do not forget <code class="docutils literal notranslate"><span class="pre">clip=False</span></code> when using <code class="docutils literal notranslate"><span class="pre">skimage.util.random_noise</span></code>, in order to add a true Gaussian noise!</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_11_0.png" src="../_images/correc5_11_0.png" />
</div>
</div>
<p>Note that the larger the SNR, the less visible the noise.
This makes sense since, in the definition of SNR, the noise power is in the denominator.
In addition, from 30 dB, the noise becomes almost invisible, while below 0 dB, it is very high and the image is hardly visible.</p>
</div>
<div class="section" id="mean-filter">
<h3>Mean filter<a class="headerlink" href="#mean-filter" title="Permalink to this headline">¶</a></h3>
<p>I choose the image whose SNR equals 10 dB, and I apply a mean filter.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_16_0.png" src="../_images/correc5_16_0.png" />
</div>
</div>
<p>We observe that the mean filter reduces the noise, which is expected (have you tried a filter of size 1×1? What’s going on?).
On the other hand, the image is more blurry: the contours are less sharp.
This second observation is explained by the fact that the mean filter is a convolution by a kernel which is not a single pulse:
so the intensities of the pixels spreads over their neighbourhood.</p>
<p>The mean square error is an objective measure of the quality of the restoration.
It is calculated between the denoised image <span class="math notranslate nohighlight">\(\hat{x}\)</span> and the original one <span class="math notranslate nohighlight">\(x\)</span>.
Therefore, the mean filter helps to decrease the MSE by reducing the noise.
But at the same time it increases the MSE by introducing blur in the image.
As a consequence, the MSE evolves with the size <code class="docutils literal notranslate"><span class="pre">w</span></code> of the filter.
To verify this hypothesis, we plot the values of the MSE with respect to <code class="docutils literal notranslate"><span class="pre">w</span></code>:</p>
<div class="cell tag_remove-input tag_hide docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The best restoration is obtained for w = 9 and get an MSE = 8.20e+01
</pre></div>
</div>
<img alt="../_images/correc5_18_1.png" src="../_images/correc5_18_1.png" />
</div>
</div>
<p>As expected, the MSE change with respect of the filter size.
A compromise must be made between the noise reduction and the blurring.
We observe that the curve has a minimum, it corresponds to the best choice for <code class="docutils literal notranslate"><span class="pre">w</span></code> (in terms of MSE).</p>
<p>Unfortunately, there is no easy way to know a priori the best size of the mean filter just knowing the SNR.
The value obtained here depends on the image (try with another image!).</p>
</div>
<div class="section" id="tv-denoising">
<h3>TV denoising<a class="headerlink" href="#tv-denoising" title="Permalink to this headline">¶</a></h3>
<p>With the noisy image at SNR = 10 dB, we now carry out a denoising by TV regularization.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_22_0.png" src="../_images/correc5_22_0.png" />
</div>
</div>
<p>As with the mean filter, we observe that the image is partially denoised (therefore the MSE will be better),
but, again, the contours are less sharp, resulting in a degradation of the MSE.
As previously, it should exist an optimal value of the regularization parameter <span class="math notranslate nohighlight">\(\lambda\)</span>.
Let’s see if this denoising technique can surpass the mean filter…</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The best restoration is obtained for lambda = 45 and get an MSE = 6.46e+01
</pre></div>
</div>
<img alt="../_images/correc5_24_1.png" src="../_images/correc5_24_1.png" />
</div>
</div>
<p>The curve has the same behavior as in the case of the mean filter:
there is an optimal value of the regularization parameter for which the MSE is the best.
Moreover, we notice that the best MSE is lower than the best MSE obtained with the mean filter.
So wa want to conclude that TV regularization is more efficient than the mean filter!
But beware: this conclusion is partial, because it was only obtained on <em>one</em> image with <em>one</em> SNR.</p>
</div>
<div class="section" id="comparison-of-the-two-denoising-methods-for-different-snrs">
<h3>Comparison of the two denoising methods for different SNRs<a class="headerlink" href="#comparison-of-the-two-denoising-methods-for-different-snrs" title="Permalink to this headline">¶</a></h3>
<p>It is possible to analyze the evolution of the MSE with respect to the noise level by calculating, for several values of SNR,
the best parameters for the two methods.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/vincent/anaconda3/lib/python3.7/site-packages/skimage/restoration/_denoise.py:358: RuntimeWarning: divide by zero encountered in double_scalars
  norm *= tau / weight
/home/vincent/anaconda3/lib/python3.7/site-packages/skimage/restoration/_denoise.py:358: RuntimeWarning: invalid value encountered in multiply
  norm *= tau / weight
</pre></div>
</div>
</div>
</div>
<p>Then we can represent the evolution of the MSE for the two methods:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_30_0.png" src="../_images/correc5_30_0.png" />
</div>
</div>
<p>We observe that the MSE decreases with the SNR.
The interpretation is easy:
the more the noise decreases, the more the image resembles the original image, and therefore denoising is less difficult.</p>
<p>In addition, we observe that:</p>
<ul class="simple">
<li><p>for SNRs lower than (approximately) 5 dB, the mean filter is better than TV regularization.
This seems surprising since the TV regularization is supposed to be better.
However, an SNR lower than 5 dB is extremely low.
In fact, neither of the two methods gives a really satisfactory result (see below).</p></li>
<li><p>for images with SNR greater than 5 dB, TV regularization is better.</p></li>
</ul>
<!-- Let us now observe the evolution of the values of the best parameters of the two methods, according to the SNR: --><div class="cell tag_remove-input docutils container">
</div>
<!-- Pour les deux méthodes, la valeur du paramètre décroît lorsque le RSB augmente.
* pour le filtre moyenneur (en bleu), la fenêtre utilisée est donc de plus en plus petite lorsque le bruit diminue. C'est logique : le bruit diminuant, il n'est pas nécessaire de moyenner sur un grand voisinage, ce qui permet de trop flouter l'image.
* pour la régularisation TV (rouge), le paramètre de régularisation est plus faible lorsque le bruit diminue. C'est également logique : en diminuant, le paramètre de régularisation donne moins de poids à la régularisation qui est là surtout pour compenser le bruit. S'il y a moins de bruit, il y a moins besoin de régulariser !

On peut vérifier que ces conclusions sont en accord avec ce qu'on peut observer sur quelques exemples : --><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_35_0.png" src="../_images/correc5_35_0.png" />
<img alt="../_images/correc5_35_1.png" src="../_images/correc5_35_1.png" />
<img alt="../_images/correc5_35_2.png" src="../_images/correc5_35_2.png" />
</div>
</div>
<p>OK, we have the same conclusions as before.</p>
<p>The comparison between the two methods was only carried out on a single image and a single criterion (the MSE).
This is undoubtedly a good criterion for comparing two methods, but comparisons exist,
such as for example the complexity of the method, the computation time, etc.</p>
</div>
</div>
<div class="section" id="deconvolution">
<h2>Déconvolution<a class="headerlink" href="#deconvolution" title="Permalink to this headline">¶</a></h2>
<p>The objectives of this exercise are:</p>
<ul class="simple">
<li><p>know how to apply a specific degradation to an image</p></li>
<li><p>understand why naive deconvolution does not work</p></li>
<li><p>implement a Wiener filter</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<div class="section" id="original-and-noisy-images">
<h3>Original and noisy images<a class="headerlink" href="#original-and-noisy-images" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_42_0.png" src="../_images/correc5_42_0.png" />
</div>
</div>
<p>The “USAF 1951” resolution chart is a tool for measuring the resolution of optical instruments.
It was designed by the U.S. Air Force.
Its interest in image processing is to measure the resolution capacity of methods.
Here, it is interesting because once blurred, it is difficult to count the lines and read the figures.</p>
</div>
<div class="section" id="inverse-filter-on-the-non-noisy-image">
<h3>Inverse filter on the non-noisy image<a class="headerlink" href="#inverse-filter-on-the-non-noisy-image" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_46_0.png" src="../_images/correc5_46_0.png" />
</div>
</div>
<p>In the absence of noise, the inverse filter works perfectly (except for a translation).</p>
</div>
<div class="section" id="inverse-filter-with-noise">
<h3>Inverse filter with noise<a class="headerlink" href="#inverse-filter-with-noise" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_49_0.png" src="../_images/correc5_49_0.png" />
</div>
</div>
<p>On the contrary, when the image is noisy (even slightly: here SNR=40 dB), the restoration is not at all acceptable!</p>
</div>
<div class="section" id="wiener-filter-with-noise">
<h3>Wiener filter with noise<a class="headerlink" href="#wiener-filter-with-noise" title="Permalink to this headline">¶</a></h3>
<p>Be careful, there is another <code class="docutils literal notranslate"><span class="pre">wiener</span></code> function (<code class="docutils literal notranslate"><span class="pre">skimage.filters.wiener</span></code>), but it is more tricky.
Instead, use <code class="docutils literal notranslate"><span class="pre">skimage.restoration.wiener</span></code>, not forgetting to add <code class="docutils literal notranslate"><span class="pre">clip=False</span></code>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_53_0.png" src="../_images/correc5_53_0.png" />
<img alt="../_images/correc5_53_1.png" src="../_images/correc5_53_1.png" />
</div>
</div>
<p>These first results have been obtained for three values of <span class="math notranslate nohighlight">\(\lambda\)</span>.
They show that in terms of MSE, there is a compromise to be made between denoising and deconvolution.
If <span class="math notranslate nohighlight">\(\lambda\)</span> is too low, the restored image is deconvolved but remains very noisy;
if <span class="math notranslate nohighlight">\(\lambda\)</span> is too large then the image remains blurry.</p>
<p>For a better analysis, we represent the MSE with respect to <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/correc5_55_0.png" src="../_images/correc5_55_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The best restoration is obtained for lambda = 90 and gives MSE = 1332.80.
</pre></div>
</div>
<img alt="../_images/correc5_55_2.png" src="../_images/correc5_55_2.png" />
</div>
</div>
<p>I find personally that this value of <span class="math notranslate nohighlight">\(\lambda\)</span> gives a less clear picture than for lower values of <span class="math notranslate nohighlight">\(\lambda\)</span> (as presented above).
This shows that the MSE does not perfectly represent the perceived quality.
But the perceived quality is subjective and depend on the desired objective, whereas MSE is an objective measure.</p>
<p>Finally, as for denoising methods, it is very difficult to set a priori the value of the parameter <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="lab5.html" title="previous page">Lab 5</a>
    <a class='right-next' id="next-link" href="lab6.html" title="next page">Lab 6</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Vincent Mazet (University of Strasbourg, France)<br/>
        
            &copy; Copyright 2021-2022.<br/>
          <div class="extra_footer">
            Basics of Image Processing &mdash; Vincent Mazet (Université de Strasbourg), 2021 &mdash; <a href='license.html'>CC BY-NC 4.0</a>.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>