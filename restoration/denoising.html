
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Denoising &#8212; Basics of Image Processing</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jbvinc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/jbvinc-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deconvolution" href="deconvolution.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Basics of Image Processing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Foreword
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Digital images
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/definition.html">
   What is a digital image?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/eye.html">
   Human vision
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/acquisition.html">
   Image acquisition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/displaying.html">
   Displaying an image
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/operations.html">
   Arithmetic operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../digital-images/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Histogram
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../histogram/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../histogram/histogram.html">
   Histogram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../histogram/transformations.html">
   Histogram transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../histogram/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Filtering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/convolution.html">
   Convolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/fourier.html">
   Fourier transform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/wavelets.html">
   Wavelets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/filtering.html">
   Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtering/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Compression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/lossless.html">
   Lossless compression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/lossy.html">
   Lossy compression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../compression/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Registration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../registration/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../registration/registration.html">
   Registration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../registration/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Interpolation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../interpolation/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpolation/interpolation.html">
   Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpolation/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Textures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../textures/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../textures/textures.html">
   Textures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../textures/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Segmentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/histogram.html">
   Histogram thresholding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/clustering.html">
   Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/region-growing.html">
   Region growing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/watershed.html">
   Watershed
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/evaluation.html">
   How to evaluate a segmentation?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../segmentation/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mathematical morphology
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/basics.html">
   Basic operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/composition.html">
   Composition of basic operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/measure.html">
   Measure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mm/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Restoration
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Denoising
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deconvolution.html">
   Deconvolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Feature detection
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/matched-filter.html">
   Matched filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/edges.html">
   Edge detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/corners.html">
   Corner detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/lines.html">
   Line detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../detection/outro.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab1.html">
   Lab 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor11.html">
     1 Getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor12.html">
     2 Display a saved image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor13.html">
     3 Display several images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor14.html">
     4 Create a simple image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor15.html">
     5 Setting the intensity range
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor16.html">
     6 Segmentation by histogram thresholding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor17.html">
     7 Contrast enhancement
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab2.html">
   Lab 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor21.html">
     Convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor22.html">
     Properties of the Fourier transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor23.html">
     Filtering aliasing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab3.html">
   Lab 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor3.html">
     Lossy compression
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab4.html">
   Lab 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor4.html">
     Segmentation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab5.html">
   Lab 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor5.html">
     Mathematical morphology
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab6.html">
   Lab 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor6.html">
     Denoising + Deconvolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/lab7.html">
   Lab 7
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/cor7.html">
     Sobel and Canny detectors + Harris detector + Hough transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  In a nutshell
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../nutshell/optimization.html">
   Mathematical optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nutshell/classification.html">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nutshell/deeplearning.html">
   Deep learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://moodle.unistra.fr/course/view.php?id=7653">
   Moodle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/python.html">
   Installing and using Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/license.html">
   License
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/restoration/denoising.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#noise-sources">
   Noise sources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additive-gaussian-white-noise">
     Additive Gaussian white noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poisson-noise">
     Poisson Noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#salt-and-pepper-noise">
     Salt-and-pepper noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#noise-power">
     Noise power
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-filter">
   Mean filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#median-filter">
   Median filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#periodic-noise-filtering">
   Periodic noise filtering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tv-regularization">
   TV regularization
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Denoising</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#noise-sources">
   Noise sources
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additive-gaussian-white-noise">
     Additive Gaussian white noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poisson-noise">
     Poisson Noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#salt-and-pepper-noise">
     Salt-and-pepper noise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#noise-power">
     Noise power
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-filter">
   Mean filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#median-filter">
   Median filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#periodic-noise-filtering">
   Periodic noise filtering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tv-regularization">
   TV regularization
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="denoising">
<span id="id1"></span><h1>Denoising<a class="headerlink" href="#denoising" title="Permalink to this headline">#</a></h1>
<p>Denoising (French: <em>débruitage</em>) consists of reducing noise in an image.
Note that it is often not possible to completely cancel the noise.
We start this section by listing the most common noise models, then we present some denoising methods.</p>
<section id="noise-sources">
<span id="denoising-noise-sources"></span><h2>Noise sources<a class="headerlink" href="#noise-sources" title="Permalink to this headline">#</a></h2>
<p>The main sources of noise in digital images are during the acquisition (quantity of photons collected too low, sensor temperature …)
or during any transmission (echoes and atmospheric distortions in wireless communication).
In some cases, noise is also considered to model the inaccuracies in the mathematical model of image formation,
the latter being necessarily different compared to reality, like any physical model!</p>
<p>The noise being by nature a random phenomenon, it is modelled by a probability density which represents the intensity distribution of the noise.</p>
<p>In the following, we denote by <span class="math notranslate nohighlight">\(y\)</span> the observed (and noisy) image, <span class="math notranslate nohighlight">\(b\)</span> the noise and <span class="math notranslate nohighlight">\(x\)</span> the non-noisy image.</p>
<section id="additive-gaussian-white-noise">
<h3>Additive Gaussian white noise<a class="headerlink" href="#additive-gaussian-white-noise" title="Permalink to this headline">#</a></h3>
<p>Additive white Gaussian noise (AWGN, in French: <em>bruit blanc gaussien additif</em>) models each pixel <span class="math notranslate nohighlight">\((m,n)\)</span> of the observation <span class="math notranslate nohighlight">\(y\)</span>
by the sum of the pixel <span class="math notranslate nohighlight">\((m,n)\)</span> of the noiseless image <span class="math notranslate nohighlight">\(x\)</span> and of a pixel of the noise <span class="math notranslate nohighlight">\(b\)</span>:</p>
<div class="math notranslate nohighlight">
\[
  \forall\, m,n \quad
  y(m,n) = x(m,n) + b(m,n)
\]</div>
<p>where <span class="math notranslate nohighlight">\(b(m,n) \sim \mathcal{N}(0,\sigma^2)\)</span>.</p>
<p>This model is simple and facilitates calculations.
It is used in most applications, including photography.</p>
</section>
<section id="poisson-noise">
<h3>Poisson Noise<a class="headerlink" href="#poisson-noise" title="Permalink to this headline">#</a></h3>
<!-- Jahne 3.4.1 -->
<p>Poisson noise (also called <em>shot noise</em>, in French: <em>bruit de Poisson</em>) models the acquisition of photons on a photosite.
The number of photons is random and depends on the illumination.
The corresponding Poisson process has a mean equals to the illumination.
The intensity of each pixel <span class="math notranslate nohighlight">\((m,n)\)</span> of the observation <span class="math notranslate nohighlight">\(y\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
  \forall\, m,n \qquad
  y(m,n) \sim \mathcal{P}\big(x(m,n)\big).
\]</div>
<p>This model is used in the case of acquisitions with a low number of photons, for example in astronomy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a reminder, the Poisson distribution <span class="math notranslate nohighlight">\(\mathcal{P}\big(\lambda\big)\)</span> writes</p>
<div class="math notranslate nohighlight">
\[
  p(k)=\frac{\lambda^k}{k\,!} e^{-\lambda}
\]</div>
<p><a class="reference internal" href="#f-denoising-poisson-distribution"><span class="std std-numref">Fig. 61</span></a> represents the Poisson distribution for three values of parameter <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<figure class="align-default" id="f-denoising-poisson-distribution">
<img alt="../_images/poisson-distribution.svg" src="../_images/poisson-distribution.svg" /><figcaption>
<p><span class="caption-number">Fig. 61 </span><span class="caption-text">Poisson distribution for three values of <span class="math notranslate nohighlight">\(\lambda\)</span>.</span><a class="headerlink" href="#f-denoising-poisson-distribution" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The mean and variance of the Poisson distribution are both equal <span class="math notranslate nohighlight">\(\lambda\)</span>, which depends on the number of incident photons.
So, the noise <span class="math notranslate nohighlight">\(b\)</span> depends on the noiseless image <span class="math notranslate nohighlight">\(x\)</span>.
Moreover, when <span class="math notranslate nohighlight">\(\lambda\)</span> increases, the Poisson distribution tends towards a Gaussian distribution,
implying that AWGN becomes a good model of whether enough photons are collected.</p>
</div>
<!-- speckle noise (different from a fish noise) -->
</section>
<section id="salt-and-pepper-noise">
<h3>Salt-and-pepper noise<a class="headerlink" href="#salt-and-pepper-noise" title="Permalink to this headline">#</a></h3>
<p>Salt-and-pepper noise (French: <em>bruit poivre et sel</em>), also called less poetically impulse noise,
models saturated or dead pixels (due to photosites malfunction or saturation).</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \forall\, m,n \quad
  y(m,n) =
  \begin{cases}
    x_\mathrm{min}      &amp;\text{with probability}\,p_\mathrm{min}, \\
    x_\mathrm{max}      &amp;\text{with probability}\,p_\mathrm{max}, \\
    x(m,n)              &amp;\text{with probability}\,1\!-\!p_\mathrm{min}\!-\!p_\mathrm{max}.
  \end{cases}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_\mathrm{min}\)</span> and <span class="math notranslate nohighlight">\(x_\mathrm{max}\)</span> are the intensity minimum and maximum.</p>
</section>
<section id="noise-power">
<h3>Noise power<a class="headerlink" href="#noise-power" title="Permalink to this headline">#</a></h3>
<p><a class="reference internal" href="#f-denoising-three-noises"><span class="std std-numref">Fig. 62</span></a> illustrates the effect of the previous noises on the same image.
On can observe that:</p>
<ul class="simple">
<li><p>for Gaussian noise, the whole image is affected in the same way by the noise,</p></li>
<li><p>for Poisson noise, the lighter parts are noisier than the dark parts,</p></li>
<li><p>for impulse noise, only a few pixels are modified and they are replaced by black or white pixels.</p></li>
</ul>
<figure class="align-default" id="f-denoising-three-noises">
<img alt="../_images/three-noises.svg" src="../_images/three-noises.svg" /><figcaption>
<p><span class="caption-number">Fig. 62 </span><span class="caption-text">Example of different types of noise (with almost the same power).</span><a class="headerlink" href="#f-denoising-three-noises" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Signal-to-noise ratio (SNR, in French: RSB for <em>rapport signal-sur-bruit</em>) is a measure of the noise level.
It is defined as the ratio between the power of the non-noisy image over the power of the noise,
where the power of an image <span class="math notranslate nohighlight">\(x\)</span> is defined by:</p>
<div class="math notranslate nohighlight">
\[
  P_x = \frac{1}{M \times N} \sum_{m,n} x(m,n)^2
\]</div>
<p>Because SNR is most often expressed on a logarithmic scale (unit: decibel), it is:</p>
<div class="math notranslate nohighlight">
\[
  \text{SNR} = 10 \log_{10} \left( \frac{\sum_{m,n} x(m,n)^2}{\sum_{m,n} b(m,n)^2} \right)
\]</div>
<p>For additive noise, another measure exists:
the peak signal-to-noise ratio (PSNR) is the ratio of the squared dynamics of the noisy image
(difference between maximum intensity and minimum intensity) to the power of the noise:</p>
<div class="math notranslate nohighlight">
\[
  \text{PSNR} = 10 \log_{10} \left( \frac{\Delta x^{\;2}}{\frac{1}{M \times N} \sum_{m,n} b(m,n)^2} \right)
\]</div>
<!-- TODO : pourquoi introduire le PSNR ? -->
<p><a class="reference internal" href="#f-denoising-snr-psnr"><span class="std std-numref">Fig. 63</span></a> represents the same image corrupted with additive white Gaussian noise, at different SNR and PSNR.
As you can see, when the RSB or the PSNR increases, then the noise decreases!</p>
<figure class="align-default" id="f-denoising-snr-psnr">
<img alt="../_images/snr-psnr.svg" src="../_images/snr-psnr.svg" /><figcaption>
<p><span class="caption-number">Fig. 63 </span><span class="caption-text">Noisy image at different RSB and PSNR.</span><a class="headerlink" href="#f-denoising-snr-psnr" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="mean-filter">
<h2>Mean filter<a class="headerlink" href="#mean-filter" title="Permalink to this headline">#</a></h2>
<p>The mean filter (French: <em>filtre moyenneur</em>) is a very simple method.
Each pixel <span class="math notranslate nohighlight">\((m,n)\)</span> of the denoised image <span class="math notranslate nohighlight">\(\widehat{x}\)</span> is the average of the pixels of the noisy image <span class="math notranslate nohighlight">\(y\)</span> around <span class="math notranslate nohighlight">\((m,n)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\forall m,\,n \quad
\widehat{x}(m,n) = \frac{1}{|V_{m,n}|} \sum_{(u,v)\in V_{m,n}} y(u,v)
\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V_{m,n}\)</span> is the neighborhood, that is the set of pixels are around <span class="math notranslate nohighlight">\((m,n)\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(|V_{m,n}| \)</span> is the cardinality of <span class="math notranslate nohighlight">\(V_{m,n}\)</span>, that is, the number of pixels in the neighborhood.</p></li>
</ul>
<p><a class="reference internal" href="#f-denoising-mean-filter-size"><span class="std std-numref">Fig. 64</span></a> illustrates the effect of the mean filter for different sizes of the neighbourhood.
If the neighbourhood grows, then the noise decreases but at the same time the image becomes more blurry.</p>
<figure class="align-default" id="f-denoising-mean-filter-size">
<img alt="../_images/mean-filter-size.svg" src="../_images/mean-filter-size.svg" /><figcaption>
<p><span class="caption-number">Fig. 64 </span><span class="caption-text">Effect of the size of the mean filter.</span><a class="headerlink" href="#f-denoising-mean-filter-size" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The mean filter can be expressed with a convolution product.
Indeed, consider the case where the neighborhood is a square of size <span class="math notranslate nohighlight">\(N\times N \)</span> pixels,
then the definition of the mean filter gives:</p>
<div class="math notranslate nohighlight">
\[
\widehat{x}(m,n)
= \frac{1}{N^2} \sum_{(u,v)\in V_{m,n}} y(u,v)
= \sum_{u,v} g(m-u,n-v) y(u,v)
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
g(u,v) =
\begin{cases}
  1/N^2  &amp;\text{if}\, u\in\left\{-\frac{N}{2},\dots,\frac{N}{2}\right\} \,\text{and}\, v\in\left\{-\frac{N}{2},\dots,\frac{N}{2}\right\} \\
  0      &amp;\text{otherwise}
\end{cases}
\end{split}\]</div>
<p>This definition can be extended to any type of kernel <span class="math notranslate nohighlight">\(g\)</span>!
For example, <a class="reference internal" href="#f-denoising-mean-filter-kernels"><span class="std std-numref">Fig. 65</span></a> gives the result for two different kernels.</p>
<figure class="align-default" id="f-denoising-mean-filter-kernels">
<img alt="../_images/mean-filter-kernels.svg" src="../_images/mean-filter-kernels.svg" /><figcaption>
<p><span class="caption-number">Fig. 65 </span><span class="caption-text">Two mean filters with different kernels.</span><a class="headerlink" href="#f-denoising-mean-filter-kernels" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In summary:</p>
<ul class="simple">
<li><p>the mean filter calculates the average of the pixels in a neighbourhood,</p></li>
<li><p>the mean filter can be written as a convolution,</p></li>
<li><p>the noise is reduced by averaging the intensities but the image is blurred.</p></li>
</ul>
</section>
<section id="median-filter">
<h2>Median filter<a class="headerlink" href="#median-filter" title="Permalink to this headline">#</a></h2>
<p>The median of a set of numbers is the element <span class="math notranslate nohighlight">\(m\)</span> of the set
such that there are as many numbers smaller than <span class="math notranslate nohighlight">\(m\)</span> as there are numbers larger than <span class="math notranslate nohighlight">\(m\)</span>.
For example, the median of <span class="math notranslate nohighlight">\(\{1,\,2,\,4,\,8,\,16\}\)</span> is <span class="math notranslate nohighlight">\(4\)</span>.</p>
<p>The median filter (French: <em>filtre médian</em>) is defined by:</p>
<div class="math notranslate nohighlight">
\[
\forall m,\,n \quad
\widehat{x}(m,n) = \mathrm{median}\big(\{y(u,v) \mid (u,v)\in V_{m,n}\}\big)
\]</div>
<p>The median filter is excellent for denoising an image in the case of salt-and-pepper noise
because it does not blur the image, as a mean filter would do.</p>
<p>Despite its name, the median filter is not a filter because it does not respect the linearity property.
Therefore it cannot be written as a convolution.</p>
<figure class="align-default" id="f-denoising-median-vs-mean">
<img alt="../_images/median-vs-mean.svg" src="../_images/median-vs-mean.svg" /><figcaption>
<p><span class="caption-number">Fig. 66 </span><span class="caption-text">Comparison between a mean filter and a median filter, on an image with salt-and-pepper noise.</span><a class="headerlink" href="#f-denoising-median-vs-mean" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="periodic-noise-filtering">
<h2>Periodic noise filtering<a class="headerlink" href="#periodic-noise-filtering" title="Permalink to this headline">#</a></h2>
<p>Periodic noises are characterized by structures in the Fourier transform.
These structures can be removed in the Fourier domain by cancelling the coefficients using a mask.
The denoised image is then obtained by an inverse Fourier transform.</p>
<figure class="align-default" id="f-denoising-periodic-noise">
<img alt="../_images/periodic-noise.svg" src="../_images/periodic-noise.svg" /><figcaption>
<p><span class="caption-number">Fig. 67 </span><span class="caption-text">Filtering a periodic noise on a photograph of the Moon:
the image is cleaned of periodic image artifacts.</span><a class="headerlink" href="#f-denoising-periodic-noise" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<!-- Estimer les paramètres du bruit
- pouquoi faire ?
- moyenne, variance, matrice de variance/covariance
- travailler sur une zone noire ou une zone ou la moyenne est connue -->
</section>
<section id="tv-regularization">
<h2>TV regularization<a class="headerlink" href="#tv-regularization" title="Permalink to this headline">#</a></h2>
<p>From a certain point of view, the goal of denoising is to obtain an image <span class="math notranslate nohighlight">\(\widehat{x}\)</span>
not only with small variations in intensity between pixels but also close to the observation <span class="math notranslate nohighlight">\(y\)</span>.
TV regularization (<em>total variation</em>, French: <em>variation totale</em>) [Rudin et al. 1992, Chambolle 2004]
is a denoising method that describes these two objectives by mathematical functions (the so-called “criteria”).</p>
<ul>
<li><p>The wish to have a denoised image <span class="math notranslate nohighlight">\(\widehat{x}\)</span> close to the observation <span class="math notranslate nohighlight">\(y\)</span> results in a “data-fit” criterion
(French: <em>critère d’adéquation aux données</em>) which measures the difference between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.
A classic choice to measure this difference is the least-squares criterion:</p>
<div class="math notranslate nohighlight">
\[
  E(x,y) = \sum_{m,n} \left(y(m,n)-x(m,n)\right)^2
  \]</div>
</li>
<li><p>The desire to have an image with small variations in intensity results in
a “regularization” criterion (French: <em>critère de régularisation</em>)
which measures the difference between the neighbouring pixels of <span class="math notranslate nohighlight">\(x\)</span>.
A simple choice is the “total variation”:</p>
<div class="math notranslate nohighlight">
\[
  R(x) = \sum_{m,n} \left|x(m+1,n)-x(m,n)\right| + \sum_{m,n} \left|x(m,n+1)-x(m,n)\right|
  \]</div>
</li>
</ul>
<p>The goal is then to find the image <span class="math notranslate nohighlight">\(x\)</span> which minimizes both the data-fit and the regularization.
Mathematically, one look for the image <span class="math notranslate nohighlight">\(x\)</span> which minimizes <span class="math notranslate nohighlight">\(E(x,y) + \lambda R(x)\)</span>,
where <span class="math notranslate nohighlight">\(\lambda\)</span> is the “regularization parameter” (French: <em>paramètre de régularisation</em>)
which is used to adjust the compromise between the two criteria.
The value of <span class="math notranslate nohighlight">\(\lambda\)</span> is chosen by the user.
Mathematically, we write:</p>
<div class="math notranslate nohighlight">
\[
\widehat{x} = \arg\min_x E(x,y) + \lambda R(x)
\]</div>
<p>This comes to an optimization problem, and there are a large number of algorithms to minimize <span class="math notranslate nohighlight">\(E(x,y) + \lambda R(x)\)</span>.
The choice and description of these algorithms are beyond the scope of the course.</p>
<figure class="align-default" id="f-denoising-tv">
<img alt="../_images/tv-denoising.svg" src="../_images/tv-denoising.svg" /><figcaption>
<p><span class="caption-number">Fig. 68 </span><span class="caption-text">Denoising with TV regularization, for two values of <span class="math notranslate nohighlight">\(\lambda\)</span>.</span><a class="headerlink" href="#f-denoising-tv" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./restoration"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="deconvolution.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Deconvolution</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Vincent Mazet (University of Strasbourg, France)<br/>
  
      &copy; Copyright 2022-2023.<br/>
    <div class="extra_footer">
      Basics of Image Processing &mdash; Vincent Mazet (Université de Strasbourg), 2020-2023 &mdash; <a href='https://vincmazet.github.io/bip/appendices/license.html'>CC BY-NC 4.0</a>.
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>